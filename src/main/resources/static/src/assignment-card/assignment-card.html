<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../mapred-config/mapred-config.html">
<link rel="import" href="../submission-status/submission-status.html">
<link rel="import" href="../common-styles/common-styles.html">

<dom-module id="assignment-card">
    <template>
        <style include="common-styles"></style>
        <paper-card heading="[[assignmentProps.name]] Due: [[_formattedDate]]" style="width: 100%">
            <div class="card-content">
                <h3>Description</h3>
                <div class="multiline" style="padding-bottom: 20px;">[[assignmentProps.desc]]</div>
                <template is="dom-repeat" items="{{submissionStatuses}}">
                    <submission-status status-props="{{item}}" style="padding: unset;"></submission-status>
                </template>
                <paper-button on-click="toggle" raised>Show/Hide Configuration</paper-button>
                <iron-collapse id="collapse_config">
                    <mapred-config id="sibmissionConfig" primary-config="[[assignmentProps.primaryConfig]]" full-config="{{submissionProps}}"></mapred-config>
                </iron-collapse>
            </div>
            <div class="card-actions">
                <paper-button on-click="submit" raised>Submit</paper-button>
                <template is="dom-if" if="{{isAdmin}}">
                    <paper-icon-button on-click="editAssignment" icon="create"></paper-icon-button>
                    <paper-icon-button on-click="deleteAssignment" icon="delete-forever"></paper-icon-button>
                </template>
            </div>
        </paper-card>
        <iron-ajax id="delete" url="/delete-assignment/{{assignmentProps.id}}" method="DELETE"></iron-ajax>
        <iron-ajax id="submitAssignment" url="/submit-assignment" method="POST"></iron-ajax>
        <iron-ajax id="getSubmissionIds" url="/submission/status/{{assignmentProps.id}}"></iron-ajax>
        <iron-ajax id="getSubmissionStatuses" url="/submission/status" content-type="application/json" method="POST"></iron-ajax>
        <paper-toast id="errorToast" class="errorToast" always-on-top></paper-toast>
    </template>

    <script src="assignment-card.js"></script>
</dom-module>